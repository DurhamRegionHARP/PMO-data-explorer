"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],r=!0,n=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done)&&(a.push(s.value),!t||a.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}!function(e,p){e.PMO=function(e){this.version="0.6.0",this.anchor=p.getElementById("cards"),this.name=e.pmoName,this.description=e.description,this.slug=e.pmoName.split(" ").join("-").toLowerCase(),this.chartData=e.estimates,this.chartsToBuild=Object.keys(e.estimates),this.container=function(){var e=p.createElement("article");return e.setAttribute("class","indicator-block indicator-".concat(this.slug)),e},this.notes=function(){if(e.trendTests)return{Notes:["Source: 2018-2019 Ontario Student Drug Use and Health Survey","Missing bars indicate an estimate is not releaseable due to small numbers"],"Trend analysis":e.trendTests,Feedback:'Your comments are welcome through our <a href="https://forms.office.com/Pages/ResponsePage.aspx?id=wsnXUknVtkGbH52hmNw_FpdyDt_B3DFNvD4pdKn3uNRUQUZGSUxKTzI3U0taMDVVVjhFWk1UQThQMCQlQCN0PWcu">feedback form</a>'};return{Notes:["Source: 2018-2019 Ontario Student Drug Use and Health Survey","Missing bars indicate an estimate is not releaseable due to small numbers"],Feedback:'Your comments are welcome through our <a href="https://forms.office.com/Pages/ResponsePage.aspx?id=wsnXUknVtkGbH52hmNw_FpdyDt_B3DFNvD4pdKn3uNRUQUZGSUxKTzI3U0taMDVVVjhFWk1UQThQMCQlQCN0PWcu">feedback form</a>'}},this.buildHeader=function(){var a=this,e=p.createElement("div"),t=p.createElement("h3"),r=p.createElement("p");e.setAttribute("class","indicator-header"),t.setAttribute("class","indicator-title"),r.setAttribute("class","indicator-desc"),r.insertAdjacentText("afterbegin",this.description),t.insertAdjacentText("afterbegin",this.name),e.appendChild(t),e.appendChild(r);var n=[];Object.keys(this.chartData).forEach(function(t){var e=p.createElement("button");e.setAttribute("class","byAll"==t?"btn btn-default active wb-toggle":"btn btn-default wb-toggle"),e.setAttribute("data-toggle",'{ "selector": "#'.concat(a.slug,"-").concat(t,'","group": ".chart-').concat(a.slug,'","type": "on"}')),e.insertAdjacentText("afterbegin",function(){var e="";switch(t){case"byAll":e="By Response Category";break;case"byGrade":e="By Grade";break;case"bySex":e="By Sex";break;case"byYear":e="By Year"}return e}()),n.push(e)});var i=p.createElement("div"),s=p.createElement("div"),o=p.createElement("a");o.insertAdjacentText("afterbegin","?");for(var c=0,l=Object.entries({class:"btn btn-sm btn-default overlay-lnk",href:"#options-hint","aria-controls":"options-hint",role:"button"});c<l.length;c++){var d=_slicedToArray(l[c],2),u=d[0],h=d[1];o.setAttribute(u,h)}return s.setAttribute("class","view-control"),i.setAttribute("class","view-mode-control btn-group-sm btn-group"),n.forEach(function(e,t){i.appendChild(e)}),s.appendChild(i),s.appendChild(o),e.appendChild(s),e},this.buildCharts=function(){var a=this,r=p.createElement("div");return r.setAttribute("class","indicator-chart"),Object.keys(this.chartData).forEach(function(e){var t=p.createElement("div");t.setAttribute("id","".concat(a.slug,"-").concat(e)),t.setAttribute("class","chart chart-".concat(a.slug)),"byAll"===e&&(t.className+=" on"),r.appendChild(t)}),r},this.buildNotes=function(){var e=p.createElement("div");e.setAttribute("class","indicator-footer");var t=p.createElement("div");t.setAttribute("class","wb-tabs");var o=p.createElement("div");return o.setAttribute("class","tabpanels"),Object.entries(this.notes()).forEach(function(e){var t=_slicedToArray(e,2),a=t[0],r=t[1],n=p.createElement("details");n.setAttribute("class","tab-".concat(a.toLowerCase()));var i,s=p.createElement("summary");s.insertAdjacentText("afterbegin",a),Array.isArray(r)?(n.appendChild(s),r.forEach(function(e){var t=p.createElement("p");t.insertAdjacentText("afterbegin",e),n.appendChild(t)})):((i=p.createElement("p")).insertAdjacentHTML("afterbegin",r),n.appendChild(s),n.appendChild(i)),o.appendChild(n)}),t.appendChild(o),e.appendChild(t),e},this.create=function(){var e=this.container();e.appendChild(this.buildHeader()),e.appendChild(this.buildCharts()),e.appendChild(this.buildNotes()),this.anchor.appendChild(e)}}}(window,document),function(c,s,l,d,n){var o=l.querySelector(".search-text"),e=l.querySelector(".index-container");function u(r){fetch("https://cdn.jsdelivr.net/gh/DurhamRegionHARP/PMO-data-explorer@gh-pages/_data/pmo.json").then(function(e){if(e.ok)return e.json();var t=l.getElementById("snackbar-error");t.classList.add("show"),setTimeout(function(){t.classList.remove("show")},3e3)}).then(function(e){var t={qry:function(e){var t=new RegExp(r.value,"i");if(t.test(e.pmoName)||t.test(e.category)||t.test(e.description)||t.test(e.tags.join(" ")))return e},cat:function(e){if(e.category.split(" ").join("-").toLowerCase()===r.value)return e},ind:function(e){if(e.pmoName.split(" ").join("-").toLowerCase()===r.value)return e}},a=e.indicators.filter(t[r.action]);"qry"===r.action&&function(e){var t=e.length,a=l.createElement("p"),r=t+" result"+(1===t?"":"s")+" found";0===t&&(r+='<p>Why not <a href="#">suggest</a> this topic be added?</p>');a.insertAdjacentHTML("afterbegin",r);var n=l.querySelector(".search-feedback");{var i;n?(n.removeChild(n.firstChild),n.appendChild(a),o.parentNode.appendChild(n)):((i=l.createElement("span")).setAttribute("class","search-feedback"),i.appendChild(a),o.parentNode.appendChild(i))}}(a),a.forEach(function(e){!function(e){var o=new n(e);{l.querySelector(".indicator-"+o.slug)||(o.create(),o.chartsToBuild.forEach(function(e){var t,a,r,n,i,s;t="#".concat(o.slug,"-").concat(e),a=o.chartData[e],r=a.series.map(function(e){return e.cl.map(function(e){return e[0]})}),n=a.series.map(function(e){return e.cl.map(function(e){return e[1]})}),i=a.series.map(function(e){return e.notes}),s={axisX:{showGrid:!1},axisY:{labelInterpolationFnc:function(e){return e+"%"},onlyInteger:!0},height:"250px",width:"1100px",high:100,low:0,showGridBackground:!0,seriesBarDistance:22,plugins:[d.plugins.errorBars({orientation:"vertical",confidenceLimit:{upper:r,lower:n}}),d.plugins.tooltip({tooltipFnc:function(e,t){var a="null"==e?"":"<br>".concat(e);return"".concat(t,"%").concat(a)}}),d.plugins.legend({className:"list-inline",clickable:!1}),d.plugins.ctAccessibility({caption:"OSDUHS Results",seriesHeader:"Analysis group",valueTransform:function(e){return e+"%"}})]},new d.Bar(t,a,s,[["screen and (max-width: 767px)",{width:"650px",seriesBarDistance:15,chartPadding:{right:25}}],["screen and (min-width: 768px)",{width:"680px",seriesBarDistance:22}],["screen and (min-width: 992px)",{seriesBarDistance:22,width:"900px"}],["screen and (min-width: 1200px)",{seriesBarDistance:22,width:"1100px"}]]).on("draw",function(e){"bar"===e.type&&e.element.attr({"ct:meta":this[e.seriesIndex][e.index]})}.bind(i)),c(".wb-toggle").trigger("wb-init.wb-toggle"),c(".wb-tabs").trigger("wb-init.wb-tabs")}),l.querySelector(".indicator-"+o.slug).addEventListener("click",function(e){var t;"BUTTON"===e.target.tagName&&((t=e.target.parentNode).hasChildNodes()&&t.childNodes.forEach(function(e){e.classList.remove("active")}),e.target.classList.add("active"))}))}}(e)})}).catch(function(e){console.log(e);var t=l.getElementById("snackbar-error");t.classList.add("show"),setTimeout(function(){t.classList.remove("show")},3e3)})}function h(){for(var e=l.getElementById("cards");e.firstChild;)e.removeChild(e.firstChild)}l.addEventListener("DOMContentLoaded",function(){o.addEventListener("input",function(e){var i=l.getElementById("cards");i.setAttribute("class","indicator-list"),"number"==typeof this.toId&&(clearTimeout(this.toId),this.toId=void 0),h(),this.toId=setTimeout(function(e){var t,a=e.target.value;if(!a.length)return(t=l.querySelector(".search-feedback"))&&o.parentNode.removeChild(t),void i.classList.remove("indicator-list");var r="#qry=".concat(a),n=r.substr(1).split("=");dataLayer.push({event:"query",query_string:n[1]}),s.location.hash=r,u({action:n[0],value:n[1].replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")})}.bind(this),600,e)}),e.addEventListener("click",function(e){var t,a,r;"index-link"===e.target.className&&(h(),l.getElementById("cards").setAttribute("class","indicator-list"),t=e.target.hash.substr(1).split("="),r=(a=c("#close-index")).data("toggle"),s.location.hash=e.target.hash,u({action:t[0],value:t[1]}),a.trigger("toggle.wb-toggle",r))})})}($,window,document,Chartist,PMO);
//# sourceMappingURL=bundle.js.map
